# ğŸ‘» GhostTap

AI é©±åŠ¨çš„ Android è¿œç¨‹æ§åˆ¶ã€‚è®© AI æˆä¸ºä½ çš„æ‰‹æœºæ›¿èº«ã€‚

[English](README_EN.md) | ç®€ä½“ä¸­æ–‡

## âœ¨ ç‰¹æ€§

- ğŸ¤– **AI è‡ªåŠ¨åŒ–** - è‡ªç„¶è¯­è¨€æè¿°ä»»åŠ¡ï¼ŒAI è‡ªåŠ¨å®Œæˆ
- ğŸ“± **æ— éšœç¢æ“ä½œ** - åŸºäº Android AccessibilityServiceï¼Œæ— éœ€ Root
- ğŸ”’ **éšç§ä¼˜å…ˆ** - æ•æ„Ÿæ“ä½œè‡ªåŠ¨æš‚åœï¼Œæ•°æ®ä¸ç•™å­˜
- ğŸŒ **å¼€æºå¯å®¡è®¡** - æœåŠ¡ç«¯ä»£ç å¼€æ”¾ï¼Œå¯è‡ªå»ºæœåŠ¡å™¨
- âš¡ **ä½å»¶è¿Ÿ** - WebSocket å®æ—¶é€šä¿¡ï¼Œå“åº” <100ms

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ä¸‹è½½ Android App

[ä¸‹è½½ APK](https://github.com/ghosttap/android/releases) æˆ–è‡ªè¡Œç¼–è¯‘

### 2. è·å–ç”¨æˆ· ID

åœ¨ OpenClaw/Feishu èŠå¤©æ¡†è¾“å…¥ï¼š
```
/get_user_id
```

å¤åˆ¶è¿”å›çš„ `user_xxx` ID

### 3. è¿æ¥æœåŠ¡ç«¯

æ‰“å¼€ GhostTap Appï¼š
1. å¡«å…¥ user_id å’ŒæœåŠ¡å™¨åœ°å€
2. å¼€å¯æ— éšœç¢æƒé™
3. å¼€å¯æ‚¬æµ®çª—æƒé™
4. ç‚¹å‡»"å¯åŠ¨æœåŠ¡"

> é€šçŸ¥æ æ˜¾ç¤º"GhostTap è¿è¡Œä¸­"ï¼Œå¯ç‚¹å‡»"åœæ­¢æœåŠ¡"æŒ‰é’®å¿«é€Ÿåœæ­¢

### 4. å¼€å§‹è‡ªåŠ¨åŒ–

å¯¹ OpenClaw/Feishu è¯´ï¼š
```
å¸®æˆ‘ç­¾åˆ°
å¸®æˆ‘ä¹°ä¸€æ¯å’–å•¡
å¸®æˆ‘å›å¤å¾®ä¿¡æ¶ˆæ¯
```

## ğŸ—ï¸ æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·: "å¸®æˆ‘ç­¾åˆ°"                    â”‚
â”‚  OpenClaw / Feishu / ä»»æ„ IM        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GhostTap Server (äº‘ç«¯)              â”‚
â”‚  - WebSocket Gateway                 â”‚
â”‚  - AI Core (LLM)                     â”‚
â”‚  - UI Formatter                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ WebSocket (wss://)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GhostTap Android (æ‰‹æœºç«¯)           â”‚
â”‚  - Accessibility Service             â”‚
â”‚  - WebSocket Client                  â”‚
â”‚  - Floating Window                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
ghosttap/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ android/          # Android å®¢æˆ·ç«¯ (Java)
â”‚   â”‚   â”œâ”€â”€ MainActivity.java          # ä¸»ç•Œé¢ (æ¸…çˆ½è®¾è®¡)
â”‚   â”‚   â”œâ”€â”€ GhostTapService.java       # æ— éšœç¢æœåŠ¡æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ WebSocketManager.java      # WebSocket è¿æ¥ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ AccessibilityCollector.java# UI é‡‡é›†å™¨
â”‚   â”‚   â”œâ”€â”€ CommandExecutor.java       # æŒ‡ä»¤æ‰§è¡Œå™¨
â”‚   â”‚   â”œâ”€â”€ FloatWindowManager.java    # æ‚¬æµ®çª—ç®¡ç†
â”‚   â”‚   â””â”€â”€ Config.java                # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ server/           # Node.js æœåŠ¡ç«¯
â”‚       â”œâ”€â”€ index.ts                  # å…¥å£æ–‡ä»¶
â”‚       â”œâ”€â”€ websocket-gateway.ts      # WebSocket ç½‘å…³
â”‚       â”œâ”€â”€ ai-core.ts                # AI å†³ç­–æ ¸å¿ƒ
â”‚       â”œâ”€â”€ session-manager.ts        # ä¼šè¯ç®¡ç†
â”‚       â”œâ”€â”€ formatter.ts              # UI æ ¼å¼åŒ–
â”‚       â””â”€â”€ database.ts               # SQLite æ•°æ®åº“
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ protocol/         # å…±äº«åè®®å®šä¹‰
â””â”€â”€ openclaw-skill/       # OpenClaw æŠ€èƒ½æ’ä»¶
```

## ğŸ”§ å¼€å‘ç¯å¢ƒ

### æœåŠ¡ç«¯

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/ghosttap/ghosttap.git
cd ghosttap

# å®‰è£…ä¾èµ–
npm run install:all

# é…ç½®ç¯å¢ƒå˜é‡
cp apps/server/.env.example apps/server/.env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ AI API Key

# å¯åŠ¨æœåŠ¡ç«¯ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
npm run dev:server
```

### Android å®¢æˆ·ç«¯

```bash
cd apps/android

# ç¼–è¯‘ Debug APK
./gradlew assembleDebug

# å®‰è£…åˆ°è®¾å¤‡
adb install app/build/outputs/apk/debug/app-debug.apk
```

### Docker éƒ¨ç½²

```bash
# ä½¿ç”¨ docker-compose
docker-compose up -d

# æˆ–ä½¿ç”¨ Dockerfile
docker build -t ghosttap-server .
docker run -p 8080:8080 -p 8081:8081 ghosttap-server
```

## âš™ï¸ é…ç½®è¯´æ˜

### æœåŠ¡ç«¯ç¯å¢ƒå˜é‡ (.env)

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `PORT` | WebSocket ç«¯å£ | 8080 |
| `AI_API_KEY` | AI æœåŠ¡ API Key | å¿…å¡« |
| `AI_MODEL` | AI æ¨¡å‹ | kimi-coding/k2p5 |
| `AI_API_URL` | AI æœåŠ¡åœ°å€ | https://api.moonshot.cn/v1/chat/completions |
| `WS_HEARTBEAT_INTERVAL` | å¿ƒè·³é—´éš” | 90000 (90ç§’) |
| `MAX_STEPS` | å•ä»»åŠ¡æœ€å¤§æ­¥æ•° | 50 |
| `TASK_TIMEOUT` | ä»»åŠ¡è¶…æ—¶æ—¶é—´ | 1800000 (30åˆ†é’Ÿ) |
| `PAUSE_TIMEOUT` | æš‚åœè¶…æ—¶æ—¶é—´ | 300000 (5åˆ†é’Ÿ) |
| `DISCONNECT_GRACE` | æ–­è¿å®½é™æœŸ | 30000 (30ç§’) |
| `DB_PATH` | SQLite è·¯å¾„ | ./data/ghosttap.db |

### Android é…ç½®

é¦–æ¬¡å¯åŠ¨æ—¶é…ç½®ï¼š
- **æœåŠ¡å™¨åœ°å€**: WebSocket åœ°å€ (å¦‚ `wss://your-server.com/ws`)
- **ç”¨æˆ· ID**: ä» OpenClaw/Feishu è·å–çš„ `user_xxx`
- **è®¾å¤‡åç§°**: ç”¨äºæ ‡è¯†è®¾å¤‡ï¼ˆå¯é€‰ï¼‰

é…ç½®è‡ªåŠ¨ä¿å­˜åˆ° SharedPreferencesã€‚

## ğŸ›¡ï¸ å®‰å…¨è®¾è®¡

### ä¸¤å±‚æ•æ„Ÿæ“ä½œæ£€æµ‹

1. **ç¬¬ä¸€å±‚ï¼ˆç¡¬æ£€æµ‹ï¼‰** - ä»£ç çº§åˆ«å…³é”®è¯åŒ¹é…
   - æ”¯ä»˜ã€å¯†ç ã€æŒ‡çº¹ç­‰å…³é”®è¯
   - é›¶å»¶è¿Ÿã€ä¸å¯ç»•è¿‡

2. **ç¬¬äºŒå±‚ï¼ˆAI è½¯æ£€æµ‹ï¼‰** - AI è¯­ä¹‰åˆ¤æ–­
   - è¯†åˆ«å˜ä½“è¡¨è¿°å’Œä¸Šä¸‹æ–‡
   - è¦†ç›–æ¨¡ç³Šåœºæ™¯

### å…¶ä»–å®‰å…¨æªæ–½

- **å•è®¾å¤‡ç»‘å®š** - åŒä¸€ user_id åªèƒ½æœ‰ä¸€ä¸ªè¿æ¥
- **TLS åŠ å¯†** - æ‰€æœ‰é€šä¿¡ä½¿ç”¨ wss://
- **æ•°æ®ä¸ç•™å­˜** - UI æ•°æ®ä»…ç”¨äºå®æ—¶å†³ç­–
- **ç™¾åˆ†æ¯”åæ ‡** - é€‚é…ä¸åŒå±å¹•å°ºå¯¸

## ğŸ¤ è´¡çŒ®

æ¬¢è¿ PR å’Œ Issueï¼

ä»£ç è§„èŒƒï¼š
- TypeScript: `strict: true` ä¸¥æ ¼æ¨¡å¼
- Java: éµå¾ª Java 17 è¯­æ³•ï¼Œæ˜¾å¼è®¿é—®ä¿®é¥°ç¬¦
- å…³é”®ç‰ˆæœ¬æ›´æ–°æ·»åŠ  `// v3.x:` æ ‡è®°

## ğŸ“„ è®¸å¯

MIT License - è¯¦è§ [LICENSE](LICENSE)

---

**å…è´£å£°æ˜**: GhostTap æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·ï¼Œè¯·éµå®ˆå„å¹³å°çš„æœåŠ¡æ¡æ¬¾ã€‚ä»…ç”¨äºä¸ªäººå­¦ä¹ å’Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä¸è¦ç”¨äºè¿åå¹³å°è§„åˆ™çš„æ“ä½œã€‚
